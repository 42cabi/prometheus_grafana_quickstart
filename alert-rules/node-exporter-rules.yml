groups:
  - name: node-exporter-rules
    rules:
      - alert: InstanceDown
        expr: up{job="%%PM_NODE_EXPORTER_JOB_NAME%%"} == 0
        for: 1ms
        labels:
          severity: critical
        annotations:
          summary: "ğŸš¨ {{ $labels.instance }} ì¸ìŠ¤í„´ìŠ¤ê°€ ì£½ì—ˆì–´ìš”.. ğŸš¨"
          description: "{{ $labels.instance }} ì¸ìŠ¤í„´ìŠ¤ê°€ 1ë¶„ ì´ìƒ ì£½ì–´ìˆì–´ìš”.. ì¡°ì¹˜ê°€ í•„ìš”í•´ìš”."

      - alert: high_cpu_utilization
        expr: 100 - (avg by (instance) (irate(node_cpu_seconds_total{job="%%PM_NODE_EXPORTER_JOB_NAME%%", mode="idle"}[5m])) * 100) > 75
        for: 30s
        labels:
          severity: warning
        annotations:
          summary: "âš ï¸ {{ $labels.instance }} ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ë†’ì€ CPU ì‚¬ìš©ë¥  ê°ì§€ëì–´ìš”: {{ $value }}% âš ï¸"
          description: "{{ $labels.instance }} ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì§€ë‚œ 30ì´ˆê°„ CPU ì‚¬ìš©ë¥ ì´ í‰ê·  75%ë¥¼ ë„˜ì—ˆì–´ìš”. í˜¸ìŠ¤íŠ¸ì˜ CPU ê´€ë¦¬ ë¬¸ì œì¼ ìˆ˜ ìˆìœ¼ë©°, ì¡°ì‚¬ê°€ í•„ìš”í•´ìš”."

      - alert: low_memory_availability
        expr: (sum by (instance) (node_memory_MemTotal_bytes{job="%%PM_NODE_EXPORTER_JOB_NAME%%"}) - sum by (instance) (node_memory_MemFree_bytes{job="%%PM_NODE_EXPORTER_JOB_NAME%%"} + node_memory_Buffers_bytes{job="%%PM_NODE_EXPORTER_JOB_NAME%%"} + node_memory_Cached_bytes{job="%%PM_NODE_EXPORTER_JOB_NAME%%"})) / sum by (instance) (node_memory_MemTotal_bytes{job="%%PM_NODE_EXPORTER_JOB_NAME%%"}) * 100 > 75
        for: 30s
        labels:
          severity: warning
        annotations:
          summary: "âš ï¸ {{ $labels.instance }} ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ë‚®ì€ ë©”ëª¨ë¦¬ ê°€ìš©ì„± ê°ì§€ëì–´ìš”: {{ $value }}% âš ï¸"
          description: "{{ $labels.instance }}ì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ ì´ ì§€ë‚œ 30ì´ˆê°„ 75%ë¥¼ ë„˜ì—ˆì–´ìš”. í˜¸ìŠ¤íŠ¸ì˜ ë©”ëª¨ë¦¬ ê´€ë¦¬ ë¬¸ì œì¼ ìˆ˜ ìˆìœ¼ë©°, ì¡°ì‚¬ê°€ í•„ìš”í•´ìš”."

      - alert: high_disk_space_utilization
        expr: (node_filesystem_size_bytes{job="%%PM_NODE_EXPORTER_JOB_NAME%%", mountpoint="/"} - node_filesystem_free_bytes{job="%%PM_NODE_EXPORTER_JOB_NAME%%", mountpoint="/"}) / node_filesystem_size_bytes{job="%%PM_NODE_EXPORTER_JOB_NAME%%", mountpoint="/"} * 100 > 75
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "âš ï¸ {{ $labels.instance }} ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ë†’ì€ ë””ìŠ¤í¬ ê³µê°„ ì‚¬ìš©ë¥  ê°ì§€ëì–´ìš”: {{ $value }}% âš ï¸"
          description: "{{ $labels.instance }}ì˜ ë””ìŠ¤í¬ ê³µê°„ ì‚¬ìš©ë¥ ì´ 75%ë¥¼ ë„˜ì—ˆì–´ìš”. ì €ì¥ ê³µê°„ ê´€ë¦¬ ë¬¸ì œë¥¼ ì˜ì‹¬í•´ë³¼ ìˆ˜ ìˆê³ , ì¡°ì‚¬ê°€ í•„ìš”í•´ìš”."

      - alert: high_ram_utilization
        expr: 100 * (1 - ((node_memory_MemFree_bytes{job="%%PM_NODE_EXPORTER_JOB_NAME%%"} + node_memory_Buffers_bytes{job="%%PM_NODE_EXPORTER_JOB_NAME%%"} + node_memory_Cached_bytes{job="%%PM_NODE_EXPORTER_JOB_NAME%%"}) / node_memory_MemTotal_bytes{job="%%PM_NODE_EXPORTER_JOB_NAME%%"})) > 75
        for: 30s
        labels:
          severity: warning
        annotations:
          summary: "âš ï¸ {{ $labels.instance }} ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ë†’ì€ RAM ì‚¬ìš©ë¥  ê°ì§€ëì–´ìš”: {{ $value }}% âš ï¸"
          description: "{{ $labels.instance }}ì˜ RAM ì‚¬ìš©ë¥ ì´ ì§€ë‚œ 30ì´ˆê°„ 75%ë¥¼ ë„˜ì—ˆì–´ìš”. í˜¸ìŠ¤íŠ¸ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œì´ë©°, ì¡°ì‚¬ê°€ í•„ìš”í•´ìš”."

      - alert: RebootRequired
        expr: node_reboot_required{job="%%PM_NODE_EXPORTER_JOB_NAME%%"} > 0
        for: 30s
        labels:
          severity: warning
        annotations:
          summary: "âš ï¸ {{ $labels.instance }} ì¸ìŠ¤í„´ìŠ¤ - ì¬ë¶€íŒ…ì´ í•„ìš”í•´ìš”. âš ï¸"
          description: "{{ $labels.instance }} ì¸ìŠ¤í„´ìŠ¤ - ì¬ë¶€íŒ…ì´ í•„ìš”í•´ìš”. ì¬ë¶€íŒ… ì‹œ IP ì£¼ì†Œê°€ ë³€ê²½ë  ìˆ˜ ìˆìœ¼ë‹ˆ ì£¼ì˜í•´ì£¼ì„¸ìš”."
